* { box-sizing: border-box; }
:root { --ink:#0b1f3b; --bg:#fff9f2; --blue:#1A87C9; --brand:#FF6B6B; --mint:#4ECDC4; --gold:#FFD166; --muted:#6b7280; --card:#ffffff; --border:#ffe7cc; }
body { margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji"; color:var(--ink); background:var(--bg); }
.view.child { font-family: Fredoka, 'Baloo 2', system-ui, -apple-system, Segoe UI, Roboto, Arial; }
.view.child h1, .view.child h2, .view.child h3 { font-family: 'Baloo 2', Fredoka, system-ui; letter-spacing: 0.2px; }
.view.parent, .view:not(.child) .card .kpi-value, .view:not(.child) .ai, .tabs, .app-header { font-family: Poppins, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
.view.parent h1, .view.parent h2, .view.parent h3 { font-family: Poppins, Inter, system-ui; letter-spacing: 0.2px; }
.view.child h2, .hero h2 { font-family: 'Baloo 2', Fredoka, cursive; letter-spacing: 0.3px; }
.app-header { position:sticky; top:0; z-index:20; backdrop-filter: blur(10px); }
.app-header.glass { background: rgba(255,255,255,0.68); border-bottom: 1px solid rgba(255, 231, 204, 0.65); box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
.nav-inner { display:flex; align-items:center; justify-content:space-between; gap:14px; padding:10px 14px; max-width: 1120px; margin: 0 auto; }
.app-header .brand { display:flex; align-items:center; gap:10px; }
.app-header .brand h1 { font-size: 18px; margin: 0; }
.header-actions { display:flex; align-items:center; gap:8px; }
.badge.pill { background:#0b1f3b; color:#fff; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700; opacity:0.85; }
.tabs { display:flex; gap:6px; align-items:center; }
.tabs.seg { background:#fff; padding:6px; border-radius:12px; border:1px solid var(--border); box-shadow: 0 6px 16px rgba(0,0,0,0.05); }
.tab { position:relative; background:transparent; border:1px solid transparent; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700; color:#334155; }
.tab.active { background:#fff7ea; color:#b45309; box-shadow: inset 0 2px 4px rgba(0,0,0,0.04); }
.tab-underline { position:absolute; left:8px; right:8px; bottom:4px; height:3px; background:linear-gradient(90deg,#FF6B6B,#1A87C9); border-radius:2px; }
.hamburger { display:none; width:38px; height:38px; border-radius:10px; border:1px solid var(--border); background:#fff; align-items:center; justify-content:center; gap:3px; flex-direction:column; }
.hamburger span { width:18px; height:2px; background:#334155; display:block; }

@media (max-width: 820px) {
	.tabs.seg { position:absolute; left:14px; right:14px; top:60px; display:none; }
	.tabs.seg.open { display:flex; }
	.hamburger { display:flex; }
}
main { padding:16px; }
.container { max-width: 980px; margin: 0 auto; }
.view h2 { margin-top:0; color:var(--blue); }
.grid { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
@media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }
.card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:14px; box-shadow: 0 4px 12px rgba(255,209,102,0.15); }
.row { display:flex; gap:8px; align-items:center; }
.primary { background: var(--brand); color:#fff; border:none; padding:12px 16px; border-radius:14px; box-shadow: 0 4px 0 rgba(0,0,0,0.12); font-weight:700; }
.primary:active { transform: translateY(1px); box-shadow: 0 3px 0 rgba(0,0,0,0.12); }
.secondary { background:#fff; color:var(--ink); border:1px solid var(--border); padding:12px 16px; border-radius:14px; box-shadow: 0 2px 6px rgba(0,0,0,0.06); }
.toggle { display:none; }
input { padding:10px 12px; border-radius:12px; border:1px solid var(--border); }
.code { font-weight:600; margin-top:6px; }
.status { color:var(--muted); margin-top:4px; }
.ai { margin-top:8px; white-space:pre-wrap; }
.muted { color:var(--muted); }
.app-footer { padding:16px; color:var(--muted); text-align:center; }
.warning { color:#b45309; }
.mascot-callout { display:inline-flex; align-items:center; gap:8px; margin:8px 0 10px; }
.mascot-callout .bubble { background:linear-gradient(90deg,#FF6B6B,#1A87C9); color:#fff; padding:6px 10px; border-radius:16px; font-weight:600; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
.video-wrap { position: relative; display: inline-block; }
.video-wrap video, .video-wrap canvas { width: 100%; max-width: 640px; height: auto; }
.video-wrap video, .video-wrap canvas { -webkit-transform: scaleX(-1); transform: scaleX(-1); transform-origin: center; }

/* Rewards */
.card.reward { background:#fffdf3; border-color:#ffe38a; }
.stars-pill { margin-left:auto; background:var(--gold); color:#000; padding:6px 10px; border-radius:999px; font-weight:700; box-shadow:0 2px 0 rgba(0,0,0,0.1); }

/* Toybox Scene (2.5D diorama) */
.toybox { position: relative; height: 420px; perspective: 900px; margin: 0 auto; max-width: 980px; }
.stage { position: relative; height: 100%; transform-style: preserve-3d; }
.wood-base { position:absolute; left: 50%; transform: translateX(-50%) translateZ(-40px) rotateX(90deg); bottom: -50px; width: 560px; height: 560px; background: linear-gradient(45deg, #c79a67, #a8753a); border-radius: 28px; box-shadow: 0 40px 60px rgba(0,0,0,0.15); }
.felt.grass { position:absolute; left:50%; transform: translateX(-50%) translateZ(0); bottom: 40px; width: 520px; height: 220px; background: radial-gradient(ellipse at center, #c6f1d0 0%, #a0e2b6 60%, #7fcf9a 100%); border-radius: 28px; box-shadow: inset 0 10px 30px rgba(0,0,0,0.12); }
.hill.clay { position:absolute; left: calc(50% - 120px); bottom: 70px; width: 240px; height: 120px; background: radial-gradient(circle at 30% 30%, #ffb3a3, #ff8c73); border-radius: 60px; filter: drop-shadow(0 8px 10px rgba(0,0,0,0.12)); }
.clay { border-radius: 24px; box-shadow: inset -6px -6px 0 rgba(255,255,255,0.35), inset 6px 6px 0 rgba(0,0,0,0.05); }
.felt { filter: blur(0.2px); }
.cloud { position:absolute; width: 120px; height: 60px; background: radial-gradient(ellipse at center, #fff 0%, #f1f5f9 70%); border-radius: 40px; opacity: 0.9; }
.tree { position:absolute; width: 70px; height: 110px; display:flex; flex-direction:column; align-items:center; justify-content:flex-end; }
.tree .trunk { width: 24px; height: 50px; background: radial-gradient(circle at 30% 30%, #d0a277, #b07b49); border-radius: 10px; }
.tree .cap { width: 70px; height: 70px; background: radial-gradient(circle at 40% 30%, #87e9a7, #5ec787); border-radius: 22px; margin-bottom: -14px; box-shadow: inset 0 12px 16px rgba(255,255,255,0.5); }
.buddy { position:absolute; left: calc(50% - 24px); bottom: 120px; width: 64px; height: 64px; display:flex; align-items:center; justify-content:center; font-size: 40px; }
.ui-layer { position:absolute; left:50%; transform: translateX(-50%); bottom: 16px; display:flex; flex-direction:column; align-items:center; gap:10px; }
.age-pill { display:flex; background:#fff; border:1px solid var(--border); padding:6px; border-radius:999px; box-shadow:0 8px 20px rgba(0,0,0,0.08); }
.chip { border:none; background:transparent; padding:8px 12px; border-radius:999px; font-weight:700; }
.chip.active { background:#fff7ea; color:#b45309; }
.gummy-btn { border:none; background: linear-gradient(180deg, #ffd39e, #ffad66); color:#5b3a00; padding:12px 16px; border-radius:16px; box-shadow: inset 0 -2px 0 rgba(255,255,255,0.5), 0 8px 16px rgba(255,173,102,0.35); font-weight:800; }
.gummy-btn.alt { background: linear-gradient(180deg, #cfe7ff, #8fc2ff); color:#0b3a6b; box-shadow: inset 0 -2px 0 rgba(255,255,255,0.7), 0 8px 16px rgba(143,194,255,0.35); }
.row.ctas { gap: 10px; }
.light-orb { position: absolute; width: 36px; height: 36px; background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.95), rgba(255,255,255,0.1)); border-radius:50%; pointer-events:none; transform: translate(-50%, -50%); mix-blend-mode: screen; filter: blur(0.2px); }

@media (max-width: 700px) {
	.toybox { height: 380px; }
	.felt.grass { width: 440px; height: 200px; }
	.wood-base { width: 480px; height: 480px; }
}

	/* Coach widget */
	.coach { position: fixed; right: 16px; bottom: 16px; z-index: 50; }
	.coach-fab { width: 56px; height: 56px; border-radius: 50%; font-size: 24px; display:flex; align-items:center; justify-content:center; }
	.coach-box { width: min(92vw, 380px); }
	.coach-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; font-weight:700; }
	.coach-msgs { max-height: 260px; overflow:auto; display:flex; flex-direction:column; gap:6px; margin-bottom:8px; }
	.msg { padding:8px 10px; border-radius:12px; }
	.msg.user { align-self:flex-end; background:#e7f3ff; }
	.msg.assistant { align-self:flex-start; background:#fff5e1; }

	/* Error boundary */
	.error-boundary { padding: 16px; }
	.error-boundary pre { background:#fffaf2; border:1px solid var(--border); border-radius:8px; padding:10px; overflow:auto; }

/* Child hero */
.hero { background: linear-gradient(90deg, #FFE8E8, #E7F7FF); border:1px solid var(--border); border-radius:18px; padding:16px; margin: 0 auto 14px; box-shadow: 0 6px 16px rgba(255,107,107,0.1); }
.hero-left { display:flex; align-items:center; gap:12px; }
.hero h2 { margin:0; color:#1A87C9; }
.hero .row { margin-top:8px; }

/* Avatar + child UI */
.avatar-badge { width:96px; height:96px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:48px; background:#fff; border:3px solid var(--gold); box-shadow:0 6px 16px rgba(0,0,0,0.08); }
.avatar-badge.sm { width:36px; height:36px; font-size:18px; border-width:2px; }
.sticker-book { display:grid; grid-template-columns: repeat(5, 40px); gap:8px; }
.sticker { width:40px; height:40px; border-radius:10px; display:flex; align-items:center; justify-content:center; border:1px dashed var(--border); background:#fffdfb; font-size:20px; }
.sticker.filled { border-style:solid; border-color:#ffcc66; background:#fff5d6; box-shadow: inset 0 2px 6px rgba(0,0,0,0.05); }
.char-picker { display:flex; gap:8px; flex-wrap:wrap; }
.char { display:flex; flex-direction:column; align-items:center; gap:6px; background:#fff; border:1px solid var(--border); padding:10px; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
.char.active { outline:3px solid var(--gold); }
.char-emoji { font-size:28px; }
.char-label { font-size:12px; color:var(--muted); }

@media (max-width: 600px) {
	.hero-left { flex-direction: column; align-items:flex-start; }
	.sticker-book { grid-template-columns: repeat(5, 32px); }
	.sticker { width:32px; height:32px; font-size:16px; }
}

/* KPIs */
.kpi { min-width: 120px; background:#fff; border:1px solid var(--border); border-radius:12px; padding:10px 12px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
.kpi-label { font-size:12px; color:var(--muted); }
.kpi-value { font-size:20px; font-weight:800; }
